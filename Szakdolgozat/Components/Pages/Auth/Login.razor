@page "/login"
@inject Services.SimpleLoginService LoginService
@inject Services.UserSession Session
@inject NavigationManager Nav

<div class="login-page">
    <div class="login-container">

        <h3 class="login-title">Szakdolgozat</h3>

        <input placeholder="Felhasználónév" @bind="username" />
        <input placeholder="Jelszó" type="password" @bind="password" />

        <button type="button" @onclick="DoLogin">Bejelentkezés</button>

        @if (!string.IsNullOrEmpty(error))
        {
            <p class="login-error">@error</p>
        }
    </div>
</div>

@code {
    string username = "";
    string password = "";
    string error = "";

    async Task DoLogin()
    {
        error = "";

        var user = await LoginService.LoginAsync(username, password);

        if (user == null)
        {
            error = "Invalid username or password";
            return;
        }

        Session.Login(user);
        Nav.NavigateTo("/");
    }
}
